<div class="change-password-container">
  <h1>Cambiar ContraseÃ±a</h1>

  <div *ngIf="error" class="error-message">{{ error }}</div>
  <div *ngIf="successMessage" class="success-message">{{ successMessage }}</div>

  <form [formGroup]="changePasswordForm" (ngSubmit)="changePassword()" class="form-container">
    <div class="form-group">
      <label for="currentPassword">ContraseÃ±a Actual *</label>
      <div class="password-input-group">
        <input 
          id="currentPassword" 
          [type]="showPassword ? 'text' : 'password'" 
          formControlName="currentPassword" 
          class="form-control"
          placeholder="Ingresa tu contraseÃ±a actual">
        <button 
          type="button" 
          class="toggle-password" 
          (click)="togglePasswordVisibility('current')"
          title="Mostrar/Ocultar contraseÃ±a">
          {{ showPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
        </button>
      </div>
      <div *ngIf="changePasswordForm.get('currentPassword')?.errors?.['required'] && changePasswordForm.get('currentPassword')?.touched" class="error-text">
        La contraseÃ±a actual es requerida
      </div>
    </div>

    <div class="form-section">
      <h3>Nueva ContraseÃ±a</h3>
      
      <div class="form-group">
        <label for="newPassword">Nueva ContraseÃ±a *</label>
        <div class="password-input-group">
          <input 
            id="newPassword" 
            [type]="showNewPassword ? 'text' : 'password'" 
            formControlName="newPassword" 
            class="form-control"
            placeholder="Crea una nueva contraseÃ±a segura">
          <button 
            type="button" 
            class="toggle-password" 
            (click)="togglePasswordVisibility('new')"
            title="Mostrar/Ocultar contraseÃ±a">
            {{ showNewPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <div *ngIf="changePasswordForm.get('newPassword')?.errors?.['required'] && changePasswordForm.get('newPassword')?.touched" class="error-text">
          La nueva contraseÃ±a es requerida
        </div>
        <div *ngIf="changePasswordForm.get('newPassword')?.errors?.['minlength'] && changePasswordForm.get('newPassword')?.touched" class="error-text">
          La contraseÃ±a debe tener al menos 8 caracteres
        </div>
        <small class="info-text">MÃ­nimo 8 caracteres. Se recomienda usar mayÃºsculas, minÃºsculas y nÃºmeros.</small>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirmar ContraseÃ±a *</label>
        <div class="password-input-group">
          <input 
            id="confirmPassword" 
            [type]="showConfirmPassword ? 'text' : 'password'" 
            formControlName="confirmPassword" 
            class="form-control"
            placeholder="Confirma tu nueva contraseÃ±a">
          <button 
            type="button" 
            class="toggle-password" 
            (click)="togglePasswordVisibility('confirm')"
            title="Mostrar/Ocultar contraseÃ±a">
            {{ showConfirmPassword ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸' }}
          </button>
        </div>
        <div *ngIf="changePasswordForm.errors?.['passwordMismatch'] && changePasswordForm.get('confirmPassword')?.touched" class="error-text">
          Las contraseÃ±as no coinciden
        </div>
      </div>
    </div>

    <div class="form-actions">
      <button type="submit" [disabled]="changePasswordForm.invalid || isSaving" class="btn btn-primary">
        {{ isSaving ? 'Cambiando...' : 'Cambiar ContraseÃ±a' }}
      </button>
      <button type="button" (click)="goBack()" class="btn btn-secondary">Cancelar</button>
    </div>

    <div class="security-tips">
      <h4>Consejos de Seguridad:</h4>
      <ul>
        <li>Usa contraseÃ±as Ãºnicas para cada servicio</li>
        <li>Combina mayÃºsculas, minÃºsculas, nÃºmeros y sÃ­mbolos</li>
        <li>Evita informaciÃ³n personal predecible</li>
        <li>No compartas tu contraseÃ±a con nadie</li>
      </ul>
    </div>
  </form>
</div>
